<svg width="950" height="750" xmlns="http://www.w3.org/2000/svg">
  <style>
    .title { font: bold 18px sans-serif; text-anchor: middle; }
    .subtitle { font: 14px sans-serif; text-anchor: middle; fill: #666; }
    .service { font: 12px sans-serif; text-anchor: middle; fill: #333; }
    .domain { font: 10px sans-serif; text-anchor: middle; fill: #666; }
    .status { font: 10px sans-serif; text-anchor: middle; }
    .active { fill: #4CAF50; }
    .migrated { fill: #2196F3; }
    .bridge { fill: #FF9800; }
    .inactive { fill: #999; }
    .arrow { stroke: #666; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    .migrate-arrow { stroke: #2196F3; stroke-width: 3; fill: none; marker-end: url(#arrowhead-blue); }
  </style>
  
  <!-- Arrow markers -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
    <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2196F3"/>
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="475" y="30" class="title">Phase 3: Staging Environment Migration</text>
  <text x="475" y="50" class="subtitle">Migrate stage.cantina.com to native following engineering success</text>
  
  <!-- Engineering (Completed) -->
  <text x="150" y="90" class="title" fill="#2196F3">Engineering (Completed)</text>
  
  <rect x="50" y="110" width="200" height="80" fill="#E3F2FD" stroke="#2196F3" stroke-width="2" rx="5"/>
  <text x="150" y="130" class="service">Engineering Environment</text>
  <text x="150" y="145" class="domain">eng.cantina.com</text>
  <text x="150" y="160" class="domain">NATIVE - No CNAME</text>
  <text x="150" y="175" class="domain">ZooKeeper, Eureka, Tokens</text>
  <text x="150" y="190" class="status migrated">MIGRATED ✅</text>
  
  <!-- Staging Migration Steps -->
  <text x="475" y="90" class="title" fill="#2196F3">Staging Migration Steps</text>
  
  <!-- Step 1: Staging ZooKeeper -->
  <rect x="300" y="110" width="350" height="90" fill="#E3F2FD" stroke="#2196F3" stroke-width="2" rx="5"/>
  <text x="475" y="130" class="service">Step 1: Staging ZooKeeper Configuration</text>
  <text x="475" y="145" class="domain">File: workspace.eureka/eureka/config.json</text>
  <text x="475" y="160" class="domain">FROM: zookeeper-{1-5}.stage.airtime.com:2181</text>
  <text x="475" y="175" class="domain">TO: zookeeper-{1-5}.stage.cantina.com:2181</text>
  <text x="475" y="190" class="domain">Update CPU allocator test configs</text>
  <text x="475" y="205" class="status migrated">MIGRATING</text>
  
  <!-- Step 2: Staging Services -->
  <rect x="300" y="210" width="350" height="80" fill="#E3F2FD" stroke="#2196F3" stroke-width="2" rx="5"/>
  <text x="475" y="230" class="service">Step 2: Staging Service Updates</text>
  <text x="475" y="245" class="domain">Platform domain references → stage.cantina.com</text>
  <text x="475" y="260" class="domain">Automation testing endpoints</text>
  <text x="475" y="275" class="domain">Deploy to staging environment</text>
  <text x="475" y="290" class="status migrated">MIGRATING</text>
  
  <!-- Production (Still Bridged) -->
  <text x="800" y="90" class="title" fill="#FF9800">Production (Still Bridged)</text>
  
  <rect x="700" y="110" width="200" height="120" fill="#FFF3E0" stroke="#FF9800" stroke-width="2" rx="5"/>
  <text x="800" y="135" class="service">Production Services</text>
  <text x="800" y="150" class="domain">platform.airtime.com</text>
  <text x="800" y="155" class="domain">+ platform.cantina.com</text>
  <text x="800" y="170" class="domain">merced.airtime.com</text>
  <text x="800" y="175" class="domain">+ merced.cantina.com</text>
  <text x="800" y="190" class="domain">yosemite.airtime.com</text>
  <text x="800" y="195" class="domain">+ yosemite.cantina.com</text>
  <text x="800" y="215" class="status bridge">CNAME BRIDGED</text>
  
  <!-- Environment Status Overview -->
  <text x="475" y="340" class="title">Environment Status After Phase 3</text>
  
  <!-- Engineering Status -->
  <rect x="100" y="360" width="200" height="100" fill="#E3F2FD" stroke="#2196F3" stroke-width="2" rx="5"/>
  <text x="200" y="380" class="service">Engineering</text>
  <text x="200" y="395" class="domain">eng.cantina.com</text>
  <text x="200" y="410" class="domain">✅ ZooKeeper native</text>
  <text x="200" y="425" class="domain">✅ Eureka native</text>
  <text x="200" y="440" class="domain">✅ Token services native</text>
  <text x="200" y="455" class="status migrated">COMPLETE</text>
  
  <!-- Staging Status -->
  <rect x="350" y="360" width="200" height="100" fill="#E3F2FD" stroke="#2196F3" stroke-width="2" rx="5"/>
  <text x="450" y="380" class="service">Staging</text>
  <text x="450" y="395" class="domain">stage.cantina.com</text>
  <text x="450" y="410" class="domain">✅ ZooKeeper native</text>
  <text x="450" y="425" class="domain">✅ Services native</text>
  <text x="450" y="440" class="domain">✅ Integration tests pass</text>
  <text x="450" y="455" class="status migrated">COMPLETE</text>
  
  <!-- Production Status -->
  <rect x="600" y="360" width="200" height="100" fill="#FFF3E0" stroke="#FF9800" stroke-width="2" rx="5"/>
  <text x="700" y="380" class="service">Production</text>
  <text x="700" y="395" class="domain">airtime.com + cantina.com</text>
  <text x="700" y="410" class="domain">⏳ Still CNAME bridged</text>
  <text x="700" y="425" class="domain">⏳ Both domains work</text>
  <text x="700" y="440" class="domain">⏳ Ready for migration</text>
  <text x="700" y="455" class="status bridge">BRIDGED</text>
  
  <!-- Critical File Updates -->
  <rect x="50" y="480" width="850" height="120" fill="#F5F5F5" stroke="#CCC" stroke-width="1" rx="5"/>
  <text x="475" y="500" class="title">Critical Files Updated in Phase 3</text>
  
  <text x="70" y="520" class="service">📁 /workspace.eureka/eureka/config.json</text>
  <text x="500" y="520" class="domain">ZooKeeper endpoints: stage.airtime.com → stage.cantina.com</text>
  
  <text x="70" y="535" class="service">📁 /workspace.eureka/eureka/server-allocator/integration_tests/configs/</text>
  <text x="500" y="535" class="domain">CPU allocator test config updates</text>
  
  <text x="70" y="550" class="service">📁 Automation scripts</text>
  <text x="500" y="550" class="domain">Update staging automation endpoints</text>
  
  <text x="70" y="565" class="service">📁 Integration test configurations</text>
  <text x="500" y="565" class="domain">Update test infrastructure references</text>
  
  <text x="70" y="580" class="service">📁 Platform service configurations</text>
  <text x="500" y="580" class="domain">Update domain references for staging</text>
  
  <!-- Validation & Rollback -->
  <text x="475" y="630" class="title">Validation & Safety</text>
  
  <rect x="100" y="650" width="300" height="80" fill="#E8F5E8" stroke="#4CAF50" stroke-width="2" rx="5"/>
  <text x="250" y="670" class="service">Validation Checks</text>
  <text x="250" y="685" class="domain">✅ Staging fully functional</text>
  <text x="250" y="700" class="domain">✅ Performance within ranges</text>
  <text x="250" y="715" class="domain">✅ No production impact</text>
  <text x="250" y="730" class="status active">VALIDATED</text>
  
  <rect x="450" y="650" width="300" height="80" fill="#FFEBEE" stroke="#F44336" stroke-width="2" rx="5"/>
  <text x="600" y="670" class="service">Rollback Strategy</text>
  <text x="600" y="685" class="domain">🔄 Revert config files</text>
  <text x="600" y="700" class="domain">🔄 Staging → CNAME bridge</text>
  <text x="600" y="715" class="domain">🔄 Independent of other envs</text>
  <text x="600" y="730" class="status" fill="#F44336">AVAILABLE</text>
  
  <!-- Risk Assessment -->
  <text x="475" y="770" class="subtitle" fill="#FF9800">Risk Level: MEDIUM - Staging isolated from production, rollback available</text>
</svg>